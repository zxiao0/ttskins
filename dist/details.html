<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1">
    <meta content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable" />
    <title></title>   
    <link rel="stylesheet" type="text/css" href="static/css/app.css" /> 
</head>
<body>
  <div class="header" id="header">
    <div class="header-bg">
      <div class="logo fl"><a href="javascript:;"><img src="static/images/comm/logo.png?v=1550646486952"></a></div> 
      <div class="menu fl">

          <a href="javascript:;" class="active">
              <span class="img">
                  <span class="icon boxIcon"></span>
              </span>
              <span>箱子</span>
          </a>

          <a href="javascript:;">
              <span class="img">
                  <span class="icon CFIcon"></span>
              </span>
              <span>众筹</span>
          </a>
          <a href="javascript:;">
              <span class="img">
                  <span class="icon rollIcon"></span>
              </span>
              <span>ROLL</span>
          </a>
          <a href="javascript:;">
              <span class="img">
                  <span class="icon MALLIcon"></span>
              </span>
              <span>商城</span>
          </a>
      </div>
      <div class="shortcut fr">
          <div class="language fl">
              <div class="selectCa">
                  
                  <div class="val" @click="show_lang()"><img src="static/images/comm/chinese.jpg?v=1550646486952"></div>
                  <div class="optionList" v-show="islang">
                      <div class="option" @click="set_lang('en')"><img src="static/images/comm/english.jpg?v=1550646486952"></div>
                      <div class="option" @click="set_lang('zh-hans')"><img src="static/images/comm/chinese.jpg?v=1550646486952"></div>
                  </div>
              </div>
          </div>
          <div class="user fl">
              
              <div class="discard">
                  <a href="javascript:void 0;" id="login_page">登录</a>
                  <a href="javascript:void 0;" id="reg_page">注册</a>
              </div>
              
          </div>
      </div>
    </div>
  </div> 

  


  <div class="drop-top">
        
    <!--content-->
    <div class="drop-lf">
      <div class="hd">
        <a href="javascript:;" id="order_time">实时掉落</a> 
        <a href="javascript:;" id="order_day">今日最佳</a>
      </div> 
      <p>隐秘掉落：<span>1250500</span></p>
    </div> 


    <div class="drop-rg">
      <div class="item active">
        <div class="swiper-container">
          <ul class="swiper-wrapper" >
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img01.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img02.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img03.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img04.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img05.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img06.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img07.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img08.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img09.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img07.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img08.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
            <li class="swiper-slide" >
              <a>
                <span class="info">
                  <i class="icon"></i>
                  <img src="static/images/upload/img09.png?v=1550646486952">
                  <em>Ak-47 Jungle Spray</em>
                  <span class="price">￥121</span>
                </span>
                <span class="userinfo"><img src="static/images/upload/head.png?v=1550646486952"><em class="name">德玛西亚</em>
                </span>
              </a>
            </li>
          </ul>
        </div> 
      </div>
    </div>

  </div>





  <div id="details">
    <div class="lottery">
      <div class="circlefont">满8增1</div>
      <div class="circleinfo" id="circleinfo">
          <div class="circle">
            <div class="circle-left"></div>
            <div class="circle-right"></div>
            <div class="circle-bottom-left"></div>
            <div class="circle-bottom-right"></div>
          </div>
          <div class="info">1/8</div>
      </div>
      <div class="caseh"><h3>箱子名字</h3>OPENED CASE</div>
      <div class="canvasBox" id="canvasContext"></div>
      <div class="lotteryB">
        <div class="allprice">总计：<span>1.99 V币</span></div>
        <div class="selectCa">
            打开个数：
            <span class="val" data-value="1">1</span>
            <span data-value="2">2</span>
            <span data-value="3">3</span>
        </div>
        <div class="Play">
            <a id="play" class="btn" href="javascript:void(0)">立即打开</a>
        </div>
        <video id="video">
          <source src="static/video/open.mp3" type="video/mp4">
        </video>
      </div>
    </div>
    <div class="dropBox">
      <div class="dropBox_t">
        <h3>箱子内容</h3>
        <p>该箱子共有<span>XX</span>件物品</p>
      </div>
      <div class="dropBox_b">
        <ul class="scrollbarArea">
          <li class="weaponItem">
            <div class="weaponR">出奖率:5%</div>
            <div class="weaponImg">
                <img src="static/images/upload/list02-img01.png?v=1550646486952">
            </div>
            <div class="weaponName">Ak-47 Jungle Spray</div>
            <div class="weaponPrice">￥121</div>
          </li>
          <li class="weaponItem">
            <div class="weaponR">出奖率:5%</div>
            <div class="weaponImg">
                <img src="static/images/upload/list02-img02.png?v=1550646486952">
            </div>
            <div class="weaponName">Ak-47 Jungle Spray</div>
            <div class="weaponPrice">￥121</div>
          </li>
          <li class="weaponItem">
            <div class="weaponR">出奖率:5%</div>
            <div class="weaponImg">
                <img src="static/images/upload/list02-img03.png?v=1550646486952">
            </div>
            <div class="weaponName">Ak-47 Jungle Spray</div>
            <div class="weaponPrice">￥121</div>
          </li>
          <li class="weaponItem">
            <div class="weaponR">出奖率:5%</div>
            <div class="weaponImg">
                <img src="static/images/upload/list02-img04.png?v=1550646486952">
            </div>
            <div class="weaponName">Ak-47 Jungle Spray</div>
            <div class="weaponPrice">￥121</div>
          </li>
          <li class="weaponItem">
            <div class="weaponR">出奖率:5%</div>
            <div class="weaponImg">
                <img src="static/images/upload/list02-img05.png?v=1550646486952">
            </div>
            <div class="weaponName">Ak-47 Jungle Spray</div>
            <div class="weaponPrice">￥121</div>
          </li>
          <li class="weaponItem">
            <div class="weaponR">出奖率:5%</div>
            <div class="weaponImg">
                <img src="static/images/upload/list02-img06.png?v=1550646486952">
            </div>
            <div class="weaponName">Ak-47 Jungle Spray</div>
            <div class="weaponPrice">￥121</div>
          </li>
          <li class="weaponItem">
            <div class="weaponR">出奖率:5%</div>
            <div class="weaponImg">
                <img src="static/images/upload/list02-img07.png?v=1550646486952">
            </div>
            <div class="weaponName">Ak-47 Jungle Spray</div>
            <div class="weaponPrice">￥121</div>
          </li>
          <li class="weaponItem">
            <div class="weaponR">出奖率:5%</div>
            <div class="weaponImg">
                <img src="static/images/upload/list02-img08.png?v=1550646486952">
            </div>
            <div class="weaponName">Ak-47 Jungle Spray</div>
            <div class="weaponPrice">￥121</div>
          </li>
        </ul>
      </div>
  </div>
    
  </div>
  <div class="footer">
      <div class="logo fl"><a href="/"><img src="static/images/comm/logo.png?v=1550646486952"></a></div>
      <div class="entrance fr">
          <a class="help" href="javascript:;"><i></i>帮助中心</a>
          <a class="terms" href="javascript:;"><i></i>使用条款</a>
      </div>
      <div class="payType fl">
          <span class="tit"><i></i>支付方式：</span>
          <span class="type">
              <i class="zfb"></i>
              <i class="wx"></i>
              <i class="yl"></i>
          </span>
      </div>
  </div>


  <script src="static/js/vendor/vue-2.4.2.js?v=1550646486952"></script> 
  <script src="static/js/vendor/axios.min.js?v=1550646486952"></script> 
  <script src="static/js/vendor/vee-validate.js?v=1550646486952"></script> 
  <script src="static/js/vendor/jquery-3.2.1.js?v=1550646486952"></script> 
  <script src="static/js/vendor/swiper.min.js?v=1550646486952"></script> 
  <script src="static/js/comm.js?v=1550646486952"></script>
  <script type="text/javascript" src="static/js/unpack_show.js?v=1550646486952"></script>

  <script> 
 
  
  new Vue ({
      el: "#details",
      components: {
      },
      data: function() {
          return {
            isAjaxLock:false
          }
      }, 
      extends: {

      },
      methods: {
          

      }, 
      mounted: function() {
          
        var per = 0.2;
        var right = document.getElementById("circleinfo").getElementsByClassName('circle-right')[0];
        var left = document.getElementById("circleinfo").getElementsByClassName('circle-left')[0];
        
        if (per <= 0.5) {  //红色区域不超过一半
            right.style.transform = `rotate(${per * 360}deg)`
        } else {    //红色区域超过一半的情况，重点部分
            right.style.transform = `rotate(180deg)`
            right.style.transition = `opacity 0s step-end 1s, transform 1s linear` //timing-function需要设为linear来达到视觉上的平缓过渡
            right.style.opacity = 0

            left.style.transition = `transform ${(per - 0.5) / 0.5}s linear 1s`
            left.style.transform = `rotate(${per * 360 - 180}deg)`
        }
          
          
        var swiper = new Swiper('.swiper-container', {
              pagination: '.swiper-pagination',
              slidesPerView: 10,
              autoplay :3000,
              autoplayDisableOnInteraction : false,
              loop : true,
              paginationClickable: true,
              spaceBetween: 2,
              breakpoints: {
                  1024: {
                      slidesPerView: 4
                  },
                  768: {
                      slidesPerView: 3
                  },
                  640: {
                      slidesPerView: 2
                  },
                  320: {
                      slidesPerView: 1
                  }
              }
          });
    
      }
  })
  </script>

  <script type="text/javascript">
        var all_items_ids = new Array();
        var dataArray = new Array();
        var idMap = new Array();

        function addDefaultData(object) {
            all_items_ids["id_" + object.id] = object;
            if (dataArray.length < 15 || object.id == -10240000) {
                dataArray.push(object);
                idMap["id_" + object.id] = true;
            }
        }
       addDefaultData({
            id:431,
            title: "AWP | Asiimov1",
            img: "static/images/upload/list02-img01.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov2",
            img: "static/images/upload/list02-img02.png"
        });
        addDefaultData({
            id:433,
            title: "AWP | Asiimov3",
            img: "static/images/upload/list02-img03.png"
        });
        addDefaultData({
            id:434,
            title: "AWP | Asiimov4",
            img: "static/images/upload/list02-img04.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov5",
            img: "static/images/upload/list02-img05.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov6",
            img: "static/images/upload/list02-img06.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov7",
            img: "static/images/upload/list02-img07.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov8",
            img: "static/images/upload/list02-img08.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov9",
            img: "static/images/upload/list02-img09.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov10",
            img: "static/images/upload/list02-img10.png"
        });
        
        addDefaultData({
            id:432,
            title: "AWP | Asiimov11",
            img: "static/images/upload/list02-img08.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov12",
            img: "static/images/upload/list02-img09.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov13",
            img: "static/images/upload/list02-img10.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov14",
            img: "static/images/upload/list02-img08.png"
        });
        addDefaultData({
            id:432,
            title: "AWP | Asiimov15",
            img: "static/images/upload/list02-img09.png"
        });

        var num = 1, timer = null;
        var currentWatingCount = 0;
        var currentCanvasCount = 1;
        var canvasList = new Array();
        var box_item_ids = null;
        var skin_item = false, test_span = false, false_balance = false;
        var success_name = "", success_order_id = "", success_image = "", success_price = "", item_unit_price = "";
        var voucher_amount = 0, wallet_current_balance = 0, sell_price_currency = 0, total_sell_price = 0;
        var trade_id = 0;

        //启动回调
        function onCanvasStart(canvas, datas) {
        }

        //结束回调
        function onCanvasStop(canvas, data) {
            $('#play').removeClass("disabled");
        }

        function createCanvas() {
            while (canvasList.length > 0) {
                canvasList.splice(0, 1);
            }
            var canvasContext = document.getElementById("canvasContext");
            canvasContext.innerHTML = "";
            var bgPanel = null;
            var padPanel = null;
            for (var index = 0; index < currentCanvasCount; index++) {
                bgPanel = document.createElement("div");
                bgPanel.className = "canvasItem";
                canvasContext.appendChild(bgPanel);
                padPanel = document.createElement("div");
                padPanel.className = "canvasContext";
                bgPanel.appendChild(padPanel);
                canvasList[index] = new UnpackCanvas(dataArray, (new Date().getTime() + "_" + index));
                canvasList[index].write(padPanel);
                canvasList[index].onStart = onCanvasStart;
                canvasList[index].onStop = onCanvasStop;
            }
            currentWatingCount = currentCanvasCount;
        }

        function doCanvasStart() {
            for (var index = 0; index < canvasList.length; index++) {
                canvasList[index].start();
                canvasList[index].over(1);
            }
        }

        function doCanvasOver(results) {
            for (var index = 0; index < canvasList.length; index++) {
                if (index + 1 > results.length) {
                    canvasList[index].over(-1);
                }
                else {
                    canvasList[index].over(results[index]);
                }
            }
        }

        $(function () {
            //多开渲染
            createCanvas();
            $(".canvasContext ul li:first-child").css("margin-left","-104px")
            $(document).on("click", ".selectCa span", function (e) {
                if($(this).hasClass("val"))return;
                num = parseInt($(this).data('value'));
                //$(this).parents(".selectCa").find(".val").html($(this).html());
                $(this).addClass("val").siblings().removeClass("val");
                e.stopPropagation();
                if (isNaN($(this).html())) {
                    currentCanvasCount = 1;
                }
                else {
                    currentCanvasCount = parseInt($(this).html());
                    if (currentCanvasCount < 1) {
                        currentCanvasCount = 1;
                    }
                }
                createCanvas();
                //选中数值显示

            });
            
            select_all_items_ids = function () {
                var id_list = [];
                $('#canvasContext .UnpackCanvas_Container li').each(function () {
                    if (!utils.isEmpty($(this).data("id"))) {
                        id_list.push($(this).data("id"));
                    }
                });
                return id_list;
            };
            // 立即打开
            $("#play").click(function () {
                
                if (!$(this).hasClass("disabled")) {
                    var myVideo=document.getElementById("video");
                    myVideo.play();
                    myVideo.onended = function() {
                        myVideo.src="static/video/Roll.mp3";
                        myVideo.load();    
                        myVideo.play();

                    };
                    $(this).addClass("disabled");
                    createCanvas();
                    doCanvasStart();
                    var id_list = select_all_items_ids();
                    var box_items_ids = [];
                    for (var i = 1; i <= num; i++) {
                        var index = 3;
                        box_items_ids.push(id_list[index]);
                    }
                    setTimeout(function () {
                        doCanvasOver(box_items_ids);
                        myVideo.src="static/video/show.mp3";
                        myVideo.load();    

                        myVideo.play();
                        myVideo.onended = function() {
                          myVideo.pause();

                      };
                        
                    }, 2000);
                }
            });
    

 


        })

    </script>
</body>
</html>